import{_ as g,o as d,c as o,a as t,F as p,f as _,g as m,t as c,h as I,i as b,v as f}from"./index-df4d67d3.js";const{VITE_APP_URL:r,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"wweilin",BASE_URL:"/Vue-week7",MODE:"production",DEV:!1,PROD:!0,SSR:!1},x={data(){return{products:[],productId:"",cart:[],loadingItem:"",data:{user:{name:"",email:"",tel:"",address:""},message:""},loadingItem:!1}},methods:{getCarts(){this.$http.get(`${r}/v2/api/${h}/cart`).then(e=>{this.cart=e.data.data,console.log(this.cart)}).catch(e=>alert(e.response.data.message))},updateCartItem(e){const l={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${r}/v2/api/${h}/cart/${e.id}`,{data:l}).then(u=>{this.getCarts(),this.loadingItem=""}).catch(u=>alert(u.response.data.message))},deleteItem(e){this.loadingItem=e.id,this.$http.delete(`${r}/v2/api/${h}/cart/${e.id}`).then(l=>{this.getCarts(),this.loadingItem=""}).catch(l=>alert(l.response.data.message))},deleteAll(){this.loadingItem=!0,this.$http.delete(`${r}/v2/api/${h}/carts`).then(e=>{this.getCarts(),this.loadingItem=!1}).catch(e=>alert(e.response.data.message))}},mounted(){this.getCarts()}},v={class:"text-end"},y=["disabled"],C={class:"table align-middle"},k=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",{class:"text-end"},"單價")])],-1),A=["disabled","onClick"],P={key:0,class:"fas fa-spinner fa-pulse"},V={key:1},w={class:"input-group input-group-sm"},E=["onUpdate:modelValue","disabled","onChange"],$=["value"],T={class:"text-end"},D=t("td",{colspan:"3",class:"text-end"},"總計",-1),R={class:"text-end"},S=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),U={class:"text-end text-success"};function q(e,l,u,B,a,i){return d(),o(p,null,[t("div",v,[t("button",{class:"btn btn-outline-danger",type:"button",disabled:a.loadingItem==="deleteAll",onClick:l[0]||(l[0]=(...s)=>i.deleteAll&&i.deleteAll(...s))},"清空購物車",8,y)]),t("table",C,[k,t("tbody",null,[a.cart.carts?(d(!0),o(p,{key:0},_(a.cart.carts,s=>(d(),o("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",style:{width:"35px"},disabled:a.loadingItem===s.id,onClick:I(n=>i.deleteItem(s),["prevent"])},[a.loadingItem===s.id?(d(),o("i",P)):(d(),o("span",V,"x"))],8,A)]),t("td",null,c(s.product.title),1),t("td",null,[t("div",w,[b(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":n=>s.qty=n,disabled:a.loadingItem===s.id,onChange:n=>i.updateCartItem(s)},[(d(),o(p,null,_(20,n=>t("option",{value:n,key:n+"1235"},c(n),9,$)),64))],40,E),[[f,s.qty]])])]),t("td",T,c(s.total),1)]))),128)):m("",!0)]),t("tfoot",null,[t("tr",null,[D,t("td",R,c(a.cart.total),1)]),t("tr",null,[S,t("td",U,c(a.cart.final_total),1)])])])],64)}const M=g(x,[["render",q]]);export{M as default};
